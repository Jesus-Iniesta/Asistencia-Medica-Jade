<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/README_COMUNICACION_DISTRIBUIDA.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/README_COMUNICACION_DISTRIBUIDA.md" />
              <option name="updatedContent" value="# Guía de Comunicación Distribuida con JADE + Socket Bridge&#10;&#10;Esta guía describe cómo ejecutar el sistema con dos computadoras intercambiando mensajes JADE mediante el `NetworkBridgeAgent`.&#10;&#10;## 1. Requisitos&#10;- Java 21 instalado en ambas máquinas.&#10;- Maven disponible en `PATH` **o** uso de tu IDE para ejecutar las clases launcher.&#10;- Red local que permita tráfico TCP en los puertos `1099` (JADE) y `6200` (puente, configurable).&#10;- Firewall actualizado para permitir conexiones entrantes/salientes en esos puertos.&#10;&#10;## 2. Computadora Principal (Recepcionista + Enfermero + Bridge)&#10;1. Obtén la IP local real (el propio `MainContainer` la imprime al inicio).&#10;2. (Opcional) Define el puerto del bridge si necesitas uno distinto:&#10;   ```powershell&#10;   $env=_('')&#10;   ```&#10;3. Ejecuta el contenedor principal:&#10;   ```powershell&#10;   cd D:\repos\Java\Asistencia-Medica-Jade&#10;   mvn -q exec:java -Dexec.mainClass=com.medical.jade.launcher.MainContainer&#10;   ```&#10;   Si Maven no está disponible, ejecuta `MainContainer` desde tu IDE.&#10;4. Conserva en pantalla los datos impresos:&#10;   - IP detectada (por ejemplo `192.168.1.50`).&#10;   - Puerto socket bridge (por defecto `6200` o el que hayas definido vía `-Dbridge.port`).&#10;&#10;## 3. Computadora Secundaria (Doctor + Bridge Cliente)&#10;1. Copia el proyecto o el artefacto ejecutable.&#10;2. Edita `src/main/java/com/medical/jade/launcher/RemoteContainer.java` y actualiza `mainHost` con la IP del paso anterior.&#10;3. Si en la principal cambiaste el puerto del bridge, ejecuta el remoto con la misma propiedad (`-Dbridge.port=&lt;puerto&gt;`).&#10;4. Arranca el contenedor remoto:&#10;   ```powershell&#10;   cd D:\repos\Java\Asistencia-Medica-Jade&#10;   mvn -q exec:java -Dexec.mainClass=com.medical.jade.launcher.RemoteContainer -Dbridge.port=6200&#10;   ```&#10;   Alternativamente, usa tu IDE para ejecutar `RemoteContainer`.&#10;5. Verifica que la consola muestre ` Bridge TCP activo…` indicando que el socket se enlazó con el servidor.&#10;&#10;## 4. Flujo de prueba recomendado&#10;1. Con ambos contenedores activos, inicia el servidor web/interfaz si lo usas habitualmente (`WebInterfaceServer`).&#10;2. Crea un paciente (desde la interfaz o levantando un `PacienteAgent`).&#10;3. Observa en la computadora principal:&#10;   - Recepcionista recibe la cita.&#10;   - Si no hay enfermero local registrado, se mostrará ` Cita enviada al doctor remoto vía bridge`.&#10;4. En la computadora secundaria, el Doctor debe mostrar ` Mensaje recibido desde puente remoto` y procesar la historia.&#10;5. Confirma que el diagnóstico vuelve al paciente y se guarda en el servidor web (si está disponible).&#10;&#10;## 5. Personalización y consejos&#10;- **Puerto del bridge**: pasa `-Dbridge.port=&lt;puerto&gt;` al lanzar ambos contenedores si necesitas evitar conflictos.&#10;- **Nombres de agentes**: por defecto se usa `Doctor`. Si cambiaste el nombre remoto, pasa ese valor como argumento al crear `Recepcionista`/`Enfermero` para que sepan a quién reenviar.&#10;- **Firewall**: abre manualmente los puertos 1099 y el del bridge en ambos equipos (Entrada y Salida, TCP).&#10;- **Diagnóstico de red**:&#10;  ```powershell&#10;  Test-NetConnection 192.168.1.50 -Port 6200   # Windows PowerShell&#10;  ping 192.168.1.50                            # Alcance ICMP&#10;  ```&#10;- **Logs**: busca en consola los mensajes con emoji `` para confirmar que los paquetes cruzan el puente.&#10;- **Detener el sistema**: cierra las ventanas de los launchers; el `NetworkBridgeAgent` se apagará automáticamente.&#10;&#10;Con esto tendrás dos plataformas JADE coordinadas mediante sockets estándar, manteniendo sincronizados los agentes de recepción/enfermería con el doctor remoto.&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/medical/jade/agents/EnfermeroAgent.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/medical/jade/agents/EnfermeroAgent.java" />
              <option name="originalContent" value="package com.medical.jade.agents;&#10;&#10;import jade.core.Agent;&#10;import jade.core.AID;&#10;import jade.lang.acl.ACLMessage;&#10;import jade.lang.acl.MessageTemplate;&#10;import com.google.gson.Gson;&#10;import com.medical.jade.messages.Cita;&#10;import com.medical.jade.messages.HistoriaClinica;&#10;import com.medical.jade.behaviours.*;&#10;&#10;public class EnfermeroAgent extends Agent {&#10;    private Gson gson = new Gson();&#10;    private int pacientesAtendidos = 0;&#10;&#10;    @Override&#10;    protected void setup() {&#10;        System.out.println(&quot;✅ Enfermero &quot; + getLocalName() + &quot; está listo&quot;);&#10;&#10;        // Registrar servicio&#10;        addBehaviour(new RegisterServiceBehaviour(&quot;atencion-medica&quot;, &quot;enfermeria&quot;));&#10;&#10;        // Monitor de actividad&#10;        MonitorAgentBehaviour monitor = new MonitorAgentBehaviour(this, 30000);&#10;        addBehaviour(monitor);&#10;&#10;        // Recibir pacientes de recepción&#10;        MessageTemplate mt = MessageTemplate.MatchPerformative(ACLMessage.REQUEST);&#10;        addBehaviour(new ReceiveMessageBehaviour(mt, msg -&gt; {&#10;            tomarSignosVitales(msg, monitor);&#10;        }));&#10;&#10;        System.out.println(&quot; Enfermero esperando pacientes...&quot;);&#10;    }&#10;&#10;    private void tomarSignosVitales(ACLMessage msg, MonitorAgentBehaviour monitor) {&#10;        String contenido = msg.getContent();&#10;        System.out.println(&quot;\n Enfermero recibió paciente&quot;);&#10;&#10;        try {&#10;            Cita cita = gson.fromJson(contenido, Cita.class);&#10;&#10;            System.out.println(&quot; Tomando signos vitales de: &quot; + cita.getNombre());&#10;&#10;            // Simular toma de signos vitales (delay)&#10;            addBehaviour(new ProcessRequestBehaviour(msg, request -&gt; {&#10;                try {&#10;                    Thread.sleep(2000); // Simular tiempo de atención&#10;&#10;                    // Crear historia clínica&#10;                    HistoriaClinica historia = new HistoriaClinica();&#10;                    historia.setPacienteId(cita.getPacienteId());&#10;                    historia.setNombrePaciente(cita.getNombre()); //  NUEVO: Pasar nombre del paciente&#10;                    historia.setPresionArterial(generarPresion());&#10;                    historia.setTemperatura(generarTemperatura());&#10;                    historia.setFrecuenciaCardiaca(generarFrecuencia());&#10;                    historia.setSintomas(cita.getSintomas());&#10;&#10;                    System.out.println(&quot; Signos vitales registrados:&quot;);&#10;                    System.out.println(&quot;   - Presión: &quot; + historia.getPresionArterial());&#10;                    System.out.println(&quot;   - Temperatura: &quot; + historia.getTemperatura() + &quot;°C&quot;);&#10;                    System.out.println(&quot;   - Frecuencia: &quot; + historia.getFrecuenciaCardiaca() + &quot; lpm&quot;);&#10;&#10;                    pacientesAtendidos++;&#10;&#10;                    // Buscar doctor y enviar historia&#10;                    addBehaviour(new SearchServiceBehaviour(&quot;atencion-medica&quot;, agents -&gt; {&#10;                        for (AID agent : agents) {&#10;                            if (agent.getLocalName().contains(&quot;Doctor&quot;)) {&#10;                                addBehaviour(new SendResponseBehaviour(&#10;                                        agent,&#10;                                        ACLMessage.REQUEST,&#10;                                        gson.toJson(historia)&#10;                                ));&#10;                                System.out.println(&quot;✉️ Historia clínica enviada al Doctor\n&quot;);&#10;                                break;&#10;                            }&#10;                        }&#10;                    }));&#10;&#10;                    monitor.incrementMessageCount();&#10;&#10;                } catch (InterruptedException e) {&#10;                    e.printStackTrace();&#10;                }&#10;            }));&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;❌ Error en enfermería: &quot; + e.getMessage());&#10;        }&#10;    }&#10;&#10;    private String generarPresion() {&#10;        int sistolica = 110 + (int)(Math.random() * 30);&#10;        int diastolica = 70 + (int)(Math.random() * 20);&#10;        return sistolica + &quot;/&quot; + diastolica;&#10;    }&#10;&#10;    private double generarTemperatura() {&#10;        return 36.0 + (Math.random() * 2);&#10;    }&#10;&#10;    private int generarFrecuencia() {&#10;        return 60 + (int)(Math.random() * 40);&#10;    }&#10;&#10;    @Override&#10;    protected void takeDown() {&#10;        System.out.println(&quot; Enfermero &quot; + getLocalName() + &quot; finalizando...&quot;);&#10;        System.out.println(&quot; Total de pacientes atendidos: &quot; + pacientesAtendidos);&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.medical.jade.agents;&#13;&#10;&#13;&#10;import jade.core.Agent;&#13;&#10;import jade.core.AID;&#13;&#10;import jade.lang.acl.ACLMessage;&#13;&#10;import jade.lang.acl.MessageTemplate;&#13;&#10;import com.google.gson.Gson;&#13;&#10;import com.medical.jade.messages.Cita;&#13;&#10;import com.medical.jade.messages.HistoriaClinica;&#13;&#10;import com.medical.jade.behaviours.*;&#13;&#10;import com.medical.jade.network.RemoteMessagingService;&#13;&#10;&#13;&#10;public class EnfermeroAgent extends Agent {&#13;&#10;    private Gson gson = new Gson();&#13;&#10;    private int pacientesAtendidos = 0;&#13;&#10;    private String remoteDoctorName = &quot;Doctor&quot;;&#13;&#10;&#13;&#10;    @Override&#13;&#10;    protected void setup() {&#13;&#10;        System.out.println(&quot;✅ Enfermero &quot; + getLocalName() + &quot; está listo&quot;);&#13;&#10;&#13;&#10;        Object[] args = getArguments();&#13;&#10;        if (args != null &amp;&amp; args.length &gt; 0 &amp;&amp; args[0] instanceof String target) {&#13;&#10;            remoteDoctorName = target;&#13;&#10;        }&#13;&#10;&#13;&#10;        // Registrar servicio&#13;&#10;        addBehaviour(new RegisterServiceBehaviour(&quot;atencion-medica&quot;, &quot;enfermeria&quot;));&#13;&#10;&#13;&#10;        // Monitor de actividad&#13;&#10;        MonitorAgentBehaviour monitor = new MonitorAgentBehaviour(this, 30000);&#13;&#10;        addBehaviour(monitor);&#13;&#10;&#13;&#10;        // Recibir pacientes de recepción&#13;&#10;        MessageTemplate mt = MessageTemplate.MatchPerformative(ACLMessage.REQUEST);&#13;&#10;        addBehaviour(new ReceiveMessageBehaviour(mt, msg -&gt; {&#13;&#10;            tomarSignosVitales(msg, monitor);&#13;&#10;        }));&#13;&#10;&#13;&#10;        System.out.println(&quot; Enfermero esperando pacientes...&quot;);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void tomarSignosVitales(ACLMessage msg, MonitorAgentBehaviour monitor) {&#13;&#10;        String contenido = msg.getContent();&#13;&#10;        System.out.println(&quot;\n Enfermero recibió paciente&quot;);&#13;&#10;&#13;&#10;        try {&#13;&#10;            Cita cita = gson.fromJson(contenido, Cita.class);&#13;&#10;&#13;&#10;            System.out.println(&quot; Tomando signos vitales de: &quot; + cita.getNombre());&#13;&#10;&#13;&#10;            // Simular toma de signos vitales (delay)&#13;&#10;            addBehaviour(new ProcessRequestBehaviour(msg, request -&gt; {&#13;&#10;                try {&#13;&#10;                    Thread.sleep(2000); // Simular tiempo de atención&#13;&#10;&#13;&#10;                    // Crear historia clínica&#13;&#10;                    HistoriaClinica historia = new HistoriaClinica();&#13;&#10;                    historia.setPacienteId(cita.getPacienteId());&#13;&#10;                    historia.setNombrePaciente(cita.getNombre()); //  NUEVO: Pasar nombre del paciente&#13;&#10;                    historia.setPresionArterial(generarPresion());&#13;&#10;                    historia.setTemperatura(generarTemperatura());&#13;&#10;                    historia.setFrecuenciaCardiaca(generarFrecuencia());&#13;&#10;                    historia.setSintomas(cita.getSintomas());&#13;&#10;&#13;&#10;                    System.out.println(&quot; Signos vitales registrados:&quot;);&#13;&#10;                    System.out.println(&quot;   - Presión: &quot; + historia.getPresionArterial());&#13;&#10;                    System.out.println(&quot;   - Temperatura: &quot; + historia.getTemperatura() + &quot;°C&quot;);&#13;&#10;                    System.out.println(&quot;   - Frecuencia: &quot; + historia.getFrecuenciaCardiaca() + &quot; lpm&quot;);&#13;&#10;&#13;&#10;                    pacientesAtendidos++;&#13;&#10;&#13;&#10;                    // Buscar doctor y enviar historia&#13;&#10;                    addBehaviour(new SearchServiceBehaviour(&quot;atencion-medica&quot;, agents -&gt; {&#13;&#10;                        for (AID agent : agents) {&#13;&#10;                            if (agent.getLocalName().contains(&quot;Doctor&quot;)) {&#13;&#10;                                addBehaviour(new SendResponseBehaviour(&#13;&#10;                                        agent,&#13;&#10;                                        ACLMessage.REQUEST,&#13;&#10;                                        gson.toJson(historia)&#13;&#10;                                ));&#13;&#10;                                System.out.println(&quot;✉️ Historia clínica enviada al Doctor\n&quot;);&#13;&#10;                                return;&#13;&#10;                            }&#13;&#10;                        }&#13;&#10;&#13;&#10;                        RemoteMessagingService.sendRemote(this,&#13;&#10;                                remoteDoctorName,&#13;&#10;                                ACLMessage.REQUEST,&#13;&#10;                                gson.toJson(historia));&#13;&#10;                        System.out.println(&quot; Historia clínica enviada al doctor remoto vía bridge\n&quot;);&#13;&#10;                    }));&#13;&#10;&#13;&#10;                    monitor.incrementMessageCount();&#13;&#10;&#13;&#10;                } catch (InterruptedException e) {&#13;&#10;                    e.printStackTrace();&#13;&#10;                }&#13;&#10;            }));&#13;&#10;&#13;&#10;        } catch (Exception e) {&#13;&#10;            System.err.println(&quot;❌ Error en enfermería: &quot; + e.getMessage());&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    private String generarPresion() {&#13;&#10;        int sistolica = 110 + (int)(Math.random() * 30);&#13;&#10;        int diastolica = 70 + (int)(Math.random() * 20);&#13;&#10;        return sistolica + &quot;/&quot; + diastolica;&#13;&#10;    }&#13;&#10;&#13;&#10;    private double generarTemperatura() {&#13;&#10;        return 36.0 + (Math.random() * 2);&#13;&#10;    }&#13;&#10;&#13;&#10;    private int generarFrecuencia() {&#13;&#10;        return 60 + (int)(Math.random() * 40);&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    protected void takeDown() {&#13;&#10;        System.out.println(&quot; Enfermero &quot; + getLocalName() + &quot; finalizando...&quot;);&#13;&#10;        System.out.println(&quot; Total de pacientes atendidos: &quot; + pacientesAtendidos);&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/medical/jade/agents/RecepcionistaAgent.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/medical/jade/agents/RecepcionistaAgent.java" />
              <option name="originalContent" value="package com.medical.jade.agents;&#10;&#10;import jade.core.Agent;&#10;import jade.core.AID;&#10;import jade.lang.acl.ACLMessage;&#10;import jade.lang.acl.MessageTemplate;&#10;import com.google.gson.Gson;&#10;import com.medical.jade.messages.Cita;&#10;import com.medical.jade.behaviours.*;&#10;&#10;public class RecepcionistaAgent extends Agent {&#10;    private Gson gson = new Gson();&#10;    private int turnosAsignados = 0;&#10;&#10;    @Override&#10;    protected void setup() {&#10;        System.out.println(&quot;✅ Recepcionista &quot; + getLocalName() + &quot; está listo&quot;);&#10;&#10;        // Registrar servicio en el DF (Directory Facilitator)&#10;        addBehaviour(new RegisterServiceBehaviour(&quot;atencion-medica&quot;, &quot;recepcion&quot;));&#10;&#10;        // Monitorear actividad cada 30 segundos&#10;        MonitorAgentBehaviour monitor = new MonitorAgentBehaviour(this, 30000);&#10;        addBehaviour(monitor);&#10;&#10;        // Behaviour principal: recibir solicitudes de citas&#10;        MessageTemplate mt = MessageTemplate.MatchPerformative(ACLMessage.REQUEST);&#10;        addBehaviour(new ReceiveMessageBehaviour(mt, msg -&gt; {&#10;            procesarSolicitudCita(msg, monitor);&#10;        }));&#10;&#10;        System.out.println(&quot; Recepcionista esperando pacientes...&quot;);&#10;    }&#10;&#10;    private void procesarSolicitudCita(ACLMessage msg, MonitorAgentBehaviour monitor) {&#10;        String contenido = msg.getContent();&#10;        System.out.println(&quot;\n Recepcionista recibió solicitud: &quot; + contenido);&#10;&#10;        try {&#10;            // Parsear solicitud&#10;            Cita cita = gson.fromJson(contenido, Cita.class);&#10;&#10;            // Asignar turno y procesar&#10;            turnosAsignados++;&#10;            cita.setNumeroTurno(turnosAsignados);&#10;            cita.setEstado(&quot;Registrado&quot;);&#10;&#10;            System.out.println(&quot; Turno asignado: &quot; + turnosAsignados);&#10;            System.out.println(&quot; Paciente: &quot; + cita.getNombre());&#10;&#10;            // Responder al solicitante&#10;            addBehaviour(new SendResponseBehaviour(&#10;                    msg.getSender(),&#10;                    ACLMessage.INFORM,&#10;                    gson.toJson(cita)&#10;            ));&#10;&#10;            // Buscar enfermero disponible y enviar&#10;            addBehaviour(new SearchServiceBehaviour(&quot;atencion-medica&quot;, agents -&gt; {&#10;                for (AID agent : agents) {&#10;                    if (agent.getLocalName().contains(&quot;Enfermero&quot;)) {&#10;                        addBehaviour(new SendResponseBehaviour(&#10;                                agent,&#10;                                ACLMessage.REQUEST,&#10;                                gson.toJson(cita)&#10;                        ));&#10;                        System.out.println(&quot;✉️ Cita enviada al Enfermero&quot;);&#10;                        break;&#10;                    }&#10;                }&#10;            }));&#10;&#10;            monitor.incrementMessageCount();&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;❌ Error procesando solicitud: &quot; + e.getMessage());&#10;            addBehaviour(new SendResponseBehaviour(&#10;                    msg.getSender(),&#10;                    ACLMessage.FAILURE,&#10;                    &quot;Error al procesar solicitud&quot;&#10;            ));&#10;        }&#10;    }&#10;&#10;    @Override&#10;    protected void takeDown() {&#10;        System.out.println(&quot; Recepcionista &quot; + getLocalName() + &quot; finalizando...&quot;);&#10;        System.out.println(&quot; Total de turnos asignados: &quot; + turnosAsignados);&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.medical.jade.agents;&#13;&#10;&#13;&#10;import jade.core.Agent;&#13;&#10;import jade.core.AID;&#13;&#10;import jade.lang.acl.ACLMessage;&#13;&#10;import jade.lang.acl.MessageTemplate;&#13;&#10;import com.google.gson.Gson;&#13;&#10;import com.medical.jade.messages.Cita;&#13;&#10;import com.medical.jade.behaviours.*;&#13;&#10;import com.medical.jade.network.RemoteMessagingService;&#13;&#10;&#13;&#10;public class RecepcionistaAgent extends Agent {&#13;&#10;    private Gson gson = new Gson();&#13;&#10;    private int turnosAsignados = 0;&#13;&#10;    private String remoteDoctorName = &quot;Doctor&quot;;&#13;&#10;&#13;&#10;    @Override&#13;&#10;    protected void setup() {&#13;&#10;        System.out.println(&quot;✅ Recepcionista &quot; + getLocalName() + &quot; está listo&quot;);&#13;&#10;        Object[] args = getArguments();&#13;&#10;        if (args != null &amp;&amp; args.length &gt; 0 &amp;&amp; args[0] instanceof String target) {&#13;&#10;            remoteDoctorName = target;&#13;&#10;        }&#13;&#10;&#13;&#10;        // Registrar servicio en el DF (Directory Facilitator)&#13;&#10;        addBehaviour(new RegisterServiceBehaviour(&quot;atencion-medica&quot;, &quot;recepcion&quot;));&#13;&#10;&#13;&#10;        // Monitorear actividad cada 30 segundos&#13;&#10;        MonitorAgentBehaviour monitor = new MonitorAgentBehaviour(this, 30000);&#13;&#10;        addBehaviour(monitor);&#13;&#10;&#13;&#10;        // Behaviour principal: recibir solicitudes de citas&#13;&#10;        MessageTemplate mt = MessageTemplate.MatchPerformative(ACLMessage.REQUEST);&#13;&#10;        addBehaviour(new ReceiveMessageBehaviour(mt, msg -&gt; {&#13;&#10;            procesarSolicitudCita(msg, monitor);&#13;&#10;        }));&#13;&#10;&#13;&#10;        System.out.println(&quot; Recepcionista esperando pacientes...&quot;);&#13;&#10;    }&#13;&#10;&#13;&#10;    private void procesarSolicitudCita(ACLMessage msg, MonitorAgentBehaviour monitor) {&#13;&#10;        String contenido = msg.getContent();&#13;&#10;        System.out.println(&quot;\n Recepcionista recibió solicitud: &quot; + contenido);&#13;&#10;&#13;&#10;        try {&#13;&#10;            // Parsear solicitud&#13;&#10;            Cita cita = gson.fromJson(contenido, Cita.class);&#13;&#10;&#13;&#10;            // Asignar turno y procesar&#13;&#10;            turnosAsignados++;&#13;&#10;            cita.setNumeroTurno(turnosAsignados);&#13;&#10;            cita.setEstado(&quot;Registrado&quot;);&#13;&#10;&#13;&#10;            System.out.println(&quot; Turno asignado: &quot; + turnosAsignados);&#13;&#10;            System.out.println(&quot; Paciente: &quot; + cita.getNombre());&#13;&#10;&#13;&#10;            // Responder al solicitante&#13;&#10;            addBehaviour(new SendResponseBehaviour(&#13;&#10;                    msg.getSender(),&#13;&#10;                    ACLMessage.INFORM,&#13;&#10;                    gson.toJson(cita)&#13;&#10;            ));&#13;&#10;&#13;&#10;            // Buscar enfermero disponible y enviar&#13;&#10;            addBehaviour(new SearchServiceBehaviour(&quot;atencion-medica&quot;, agents -&gt; {&#13;&#10;                for (AID agent : agents) {&#13;&#10;                    if (agent.getLocalName().contains(&quot;Enfermero&quot;)) {&#13;&#10;                        addBehaviour(new SendResponseBehaviour(&#13;&#10;                                agent,&#13;&#10;                                ACLMessage.REQUEST,&#13;&#10;                                gson.toJson(cita)&#13;&#10;                        ));&#13;&#10;                        System.out.println(&quot;✉️ Cita enviada al Enfermero&quot;);&#13;&#10;                        return;&#13;&#10;                    }&#13;&#10;                }&#13;&#10;&#13;&#10;                // Si no hay enfermeros locales, reenviar al remoto via socket&#13;&#10;                RemoteMessagingService.sendRemote(this,&#13;&#10;                        remoteDoctorName,&#13;&#10;                        ACLMessage.REQUEST,&#13;&#10;                        gson.toJson(cita));&#13;&#10;                System.out.println(&quot; Cita enviada al doctor remoto vía bridge&quot;);&#13;&#10;            }));&#13;&#10;&#13;&#10;            monitor.incrementMessageCount();&#13;&#10;&#13;&#10;        } catch (Exception e) {&#13;&#10;            System.err.println(&quot;❌ Error procesando solicitud: &quot; + e.getMessage());&#13;&#10;            addBehaviour(new SendResponseBehaviour(&#13;&#10;                    msg.getSender(),&#13;&#10;                    ACLMessage.FAILURE,&#13;&#10;                    &quot;Error al procesar solicitud&quot;&#13;&#10;            ));&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    protected void takeDown() {&#13;&#10;        System.out.println(&quot; Recepcionista &quot; + getLocalName() + &quot; finalizando...&quot;);&#13;&#10;        System.out.println(&quot; Total de turnos asignados: &quot; + turnosAsignados);&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/medical/jade/launcher/MainContainer.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/medical/jade/launcher/MainContainer.java" />
              <option name="originalContent" value="package com.medical.jade.launcher;&#10;&#10;import jade.core.Runtime;&#10;import jade.core.Profile;&#10;import jade.core.ProfileImpl;&#10;import jade.wrapper.AgentController;&#10;import jade.wrapper.ContainerController;&#10;import java.net.InetAddress;&#10;import java.net.NetworkInterface;&#10;import java.util.Enumeration;&#10;&#10;public class MainContainer {&#10;    public static void main(String[] args) {&#10;        try {&#10;            // Configuración del contenedor principal&#10;            Runtime rt = Runtime.instance();&#10;            Profile profile = new ProfileImpl();&#10;&#10;            // Obtener la IP local REAL (evitando VirtualBox y loopback)&#10;            String localIP = getRealLocalIP();&#10;&#10;            System.out.println(&quot;===========================================&quot;);&#10;            System.out.println(&quot; DETECTANDO CONFIGURACIÓN DE RED...&quot;);&#10;            System.out.println(&quot;===========================================&quot;);&#10;            System.out.println(&quot; IP detectada: &quot; + localIP);&#10;&#10;            // Configuración CRÍTICA para conexiones remotas&#10;            profile.setParameter(Profile.MAIN_HOST, localIP);&#10;            profile.setParameter(Profile.LOCAL_HOST, localIP);  // ⬅️ IMPORTANTE para conexiones remotas&#10;            profile.setParameter(Profile.MAIN_PORT, &quot;1099&quot;);&#10;            profile.setParameter(Profile.GUI, &quot;true&quot;);&#10;            profile.setParameter(Profile.PLATFORM_ID, &quot;hospital-main&quot;);&#10;&#10;            // Configuración adicional para aceptar conexiones remotas&#10;            profile.setParameter(Profile.ACCEPT_FOREIGN_AGENTS, &quot;true&quot;);&#10;&#10;            // Crear contenedor principal&#10;            ContainerController mainContainer = rt.createMainContainer(profile);&#10;&#10;            System.out.println(&quot;\n===========================================&quot;);&#10;            System.out.println(&quot; COMPUTADORA PRINCIPAL - INICIADA&quot;);&#10;            System.out.println(&quot;===========================================&quot;);&#10;            System.out.println(&quot; IP del Servidor: &quot; + localIP);&#10;            System.out.println(&quot; Puerto JADE: 1099&quot;);&#10;            System.out.println(&quot; Puerto Web: 7070&quot;);&#10;            System.out.println(&quot;===========================================&quot;);&#10;&#10;            System.out.println(&quot;\n INSTRUCCIONES PARA COMPUTADORA SECUNDARIA:&quot;);&#10;            System.out.println(&quot;   1. Abre RemoteContainer.java&quot;);&#10;            System.out.println(&quot;   2. Cambia la línea 26 a:&quot;);&#10;            System.out.println(&quot;      String mainHost = \&quot;&quot; + localIP + &quot;\&quot;;&quot;);&#10;            System.out.println(&quot;   3. Ejecuta RemoteContainer&quot;);&#10;            System.out.println(&quot;===========================================\n&quot;);&#10;&#10;            // COMPUTADORA PRINCIPAL: Recepcionista + Enfermero&#10;            AgentController recepcionista = mainContainer.createNewAgent(&#10;                    &quot;Recepcionista&quot;,&#10;                    &quot;com.medical.jade.agents.RecepcionistaAgent&quot;,&#10;                    null&#10;            );&#10;&#10;            AgentController enfermero = mainContainer.createNewAgent(&#10;                    &quot;Enfermero&quot;,&#10;                    &quot;com.medical.jade.agents.EnfermeroAgent&quot;,&#10;                    null&#10;            );&#10;&#10;            // Iniciar agentes&#10;            recepcionista.start();&#10;            enfermero.start();&#10;&#10;            System.out.println(&quot;✅ AGENTES ACTIVOS EN COMPUTADORA PRINCIPAL:&quot;);&#10;            System.out.println(&quot;   1. Recepcionista - Registra citas&quot;);&#10;            System.out.println(&quot;   2. Enfermero - Toma signos vitales&quot;);&#10;            System.out.println(&quot;\n⏳ Esperando conexión de Computadora Secundaria (Doctor)...\n&quot;);&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;❌ ERROR AL INICIAR CONTENEDOR PRINCIPAL:&quot;);&#10;            e.printStackTrace();&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Obtiene la IP local real, evitando direcciones loopback y VirtualBox&#10;     */&#10;    private static String getRealLocalIP() {&#10;        try {&#10;            Enumeration&lt;NetworkInterface&gt; networkInterfaces = NetworkInterface.getNetworkInterfaces();&#10;&#10;            while (networkInterfaces.hasMoreElements()) {&#10;                NetworkInterface ni = networkInterfaces.nextElement();&#10;&#10;                // Saltar interfaces loopback, no activas, y VirtualBox&#10;                if (ni.isLoopback() || !ni.isUp() || ni.getDisplayName().toLowerCase().contains(&quot;virtual&quot;)) {&#10;                    continue;&#10;                }&#10;&#10;                // Preferir interfaces WiFi o Ethernet&#10;                String niName = ni.getName().toLowerCase();&#10;                boolean isPreferred = niName.startsWith(&quot;wlan&quot;) ||&#10;                                     niName.startsWith(&quot;eth&quot;) ||&#10;                                     niName.startsWith(&quot;en&quot;) ||&#10;                                     niName.startsWith(&quot;wlp&quot;);&#10;&#10;                Enumeration&lt;InetAddress&gt; addresses = ni.getInetAddresses();&#10;                while (addresses.hasMoreElements()) {&#10;                    InetAddress addr = addresses.nextElement();&#10;&#10;                    // Buscar IPv4 que NO sea loopback ni VirtualBox&#10;                    String hostAddress = addr.getHostAddress();&#10;                    if (!addr.isLoopbackAddress() &amp;&amp;&#10;                        hostAddress.indexOf(':') == -1 &amp;&amp;  // No IPv6&#10;                        !hostAddress.startsWith(&quot;127.&quot;) &amp;&amp;&#10;                        !hostAddress.startsWith(&quot;192.168.56.&quot;) &amp;&amp; // VirtualBox&#10;                        !hostAddress.startsWith(&quot;192.168.122.&quot;)) { // Otras VMs&#10;&#10;                        if (isPreferred) {&#10;                            return hostAddress; // Retornar inmediatamente si es una interfaz preferida&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            // Fallback: intentar método estándar&#10;            InetAddress localHost = InetAddress.getLocalHost();&#10;            String ip = localHost.getHostAddress();&#10;&#10;            if (!ip.startsWith(&quot;127.&quot;) &amp;&amp; !ip.startsWith(&quot;192.168.56.&quot;)) {&#10;                return ip;&#10;            }&#10;&#10;            // Último recurso&#10;            System.err.println(&quot;⚠️  No se detectó IP de red real. Usando localhost.&quot;);&#10;            System.err.println(&quot; Conecta a WiFi o Ethernet para usar en red.&quot;);&#10;            return &quot;localhost&quot;;&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;⚠️  Error detectando IP, usando localhost&quot;);&#10;            e.printStackTrace();&#10;            return &quot;localhost&quot;;&#10;        }&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.medical.jade.launcher;&#10;&#10;import com.medical.jade.agents.NetworkBridgeAgent;&#10;import jade.core.Runtime;&#10;import jade.core.Profile;&#10;import jade.core.ProfileImpl;&#10;import jade.wrapper.AgentController;&#10;import jade.wrapper.ContainerController;&#10;import java.net.InetAddress;&#10;import java.net.NetworkInterface;&#10;import java.util.Enumeration;&#10;&#10;public class MainContainer {&#10;    public static void main(String[] args) {&#10;        try {&#10;            // Configuración del contenedor principal&#10;            Runtime rt = Runtime.instance();&#10;            Profile profile = new ProfileImpl();&#10;&#10;            // Obtener la IP local REAL (evitando VirtualBox y loopback)&#10;            String localIP = getRealLocalIP();&#10;            int bridgePort = Integer.parseInt(System.getProperty(&#10;                    &quot;bridge.port&quot;,&#10;                    String.valueOf(NetworkBridgeAgent.DEFAULT_PORT)));&#10;&#10;            System.out.println(&quot;===========================================&quot;);&#10;            System.out.println(&quot; DETECTANDO CONFIGURACIÓN DE RED...&quot;);&#10;            System.out.println(&quot;===========================================&quot;);&#10;            System.out.println(&quot; IP detectada: &quot; + localIP);&#10;            System.out.println(&quot; Puerto socket puente: &quot; + bridgePort);&#10;&#10;            // Configuración CRÍTICA para conexiones remotas&#10;            profile.setParameter(Profile.MAIN_HOST, localIP);&#10;            profile.setParameter(Profile.LOCAL_HOST, localIP);  // ⬅️ IMPORTANTE para conexiones remotas&#10;            profile.setParameter(Profile.MAIN_PORT, &quot;1099&quot;);&#10;            profile.setParameter(Profile.GUI, &quot;true&quot;);&#10;            profile.setParameter(Profile.PLATFORM_ID, &quot;hospital-main&quot;);&#10;&#10;            // Configuración adicional para aceptar conexiones remotas&#10;            profile.setParameter(Profile.ACCEPT_FOREIGN_AGENTS, &quot;true&quot;);&#10;&#10;            // Crear contenedor principal&#10;            ContainerController mainContainer = rt.createMainContainer(profile);&#10;&#10;            // Crear puente de red vía sockets&#10;            AgentController networkBridge = mainContainer.createNewAgent(&#10;                    NetworkBridgeAgent.AGENT_NAME,&#10;                    &quot;com.medical.jade.agents.NetworkBridgeAgent&quot;,&#10;                    new Object[]{NetworkBridgeAgent.Mode.SERVER.name(), bridgePort}&#10;            );&#10;            networkBridge.start();&#10;&#10;            System.out.println(&quot;\n===========================================&quot;);&#10;            System.out.println(&quot; COMPUTADORA PRINCIPAL - INICIADA&quot;);&#10;            System.out.println(&quot;===========================================&quot;);&#10;            System.out.println(&quot; IP del Servidor: &quot; + localIP);&#10;            System.out.println(&quot; Puerto JADE: 1099&quot;);&#10;            System.out.println(&quot; Puerto Web: 7070&quot;);&#10;            System.out.println(&quot; Puerto Socket JADE Bridge: &quot; + bridgePort);&#10;            System.out.println(&quot;===========================================&quot;);&#10;&#10;            System.out.println(&quot;\n INSTRUCCIONES PARA COMPUTADORA SECUNDARIA:&quot;);&#10;            System.out.println(&quot;   1. Abre RemoteContainer.java&quot;);&#10;            System.out.println(&quot;   2. Cambia la línea 26 a:&quot;);&#10;            System.out.println(&quot;      String mainHost = \&quot;&quot; + localIP + &quot;\&quot;;&quot;);&#10;            System.out.println(&quot;   3. Ajusta RemoteContainer para usar el puerto &quot; + bridgePort + &quot; (bridgePort)&quot;);&#10;            System.out.println(&quot;   4. Ejecuta RemoteContainer&quot;);&#10;            System.out.println(&quot;===========================================\n&quot;);&#10;&#10;            // COMPUTADORA PRINCIPAL: Recepcionista + Enfermero&#10;            AgentController recepcionista = mainContainer.createNewAgent(&#10;                    &quot;Recepcionista&quot;,&#10;                    &quot;com.medical.jade.agents.RecepcionistaAgent&quot;,&#10;                    null&#10;            );&#10;&#10;            AgentController enfermero = mainContainer.createNewAgent(&#10;                    &quot;Enfermero&quot;,&#10;                    &quot;com.medical.jade.agents.EnfermeroAgent&quot;,&#10;                    null&#10;            );&#10;&#10;            // Iniciar agentes&#10;            recepcionista.start();&#10;            enfermero.start();&#10;&#10;            System.out.println(&quot;✅ AGENTES ACTIVOS EN COMPUTADORA PRINCIPAL:&quot;);&#10;            System.out.println(&quot;   1. Recepcionista - Registra citas&quot;);&#10;            System.out.println(&quot;   2. Enfermero - Toma signos vitales&quot;);&#10;            System.out.println(&quot;   3. NetworkBridge - Encaminamiento TCP&quot;);&#10;            System.out.println(&quot;\n⏳ Esperando conexión de Computadora Secundaria (Doctor)...\n&quot;);&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;❌ ERROR AL INICIAR CONTENEDOR PRINCIPAL:&quot;);&#10;            e.printStackTrace();&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Obtiene la IP local real, evitando direcciones loopback y VirtualBox&#10;     */&#10;    private static String getRealLocalIP() {&#10;        try {&#10;            Enumeration&lt;NetworkInterface&gt; networkInterfaces = NetworkInterface.getNetworkInterfaces();&#10;&#10;            while (networkInterfaces.hasMoreElements()) {&#10;                NetworkInterface ni = networkInterfaces.nextElement();&#10;&#10;                // Saltar interfaces loopback, no activas, y VirtualBox&#10;                if (ni.isLoopback() || !ni.isUp() || ni.getDisplayName().toLowerCase().contains(&quot;virtual&quot;)) {&#10;                    continue;&#10;                }&#10;&#10;                // Preferir interfaces WiFi o Ethernet&#10;                String niName = ni.getName().toLowerCase();&#10;                boolean isPreferred = niName.startsWith(&quot;wlan&quot;) ||&#10;                                     niName.startsWith(&quot;eth&quot;) ||&#10;                                     niName.startsWith(&quot;en&quot;) ||&#10;                                     niName.startsWith(&quot;wlp&quot;);&#10;&#10;                Enumeration&lt;InetAddress&gt; addresses = ni.getInetAddresses();&#10;                while (addresses.hasMoreElements()) {&#10;                    InetAddress addr = addresses.nextElement();&#10;&#10;                    // Buscar IPv4 que NO sea loopback ni VirtualBox&#10;                    String hostAddress = addr.getHostAddress();&#10;                    if (!addr.isLoopbackAddress() &amp;&amp;&#10;                        hostAddress.indexOf(':') == -1 &amp;&amp;  // No IPv6&#10;                        !hostAddress.startsWith(&quot;127.&quot;) &amp;&amp;&#10;                        !hostAddress.startsWith(&quot;192.168.56.&quot;) &amp;&amp; // VirtualBox&#10;                        !hostAddress.startsWith(&quot;192.168.122.&quot;)) { // Otras VMs&#10;&#10;                        if (isPreferred) {&#10;                            return hostAddress; // Retornar inmediatamente si es una interfaz preferida&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            // Fallback: intentar método estándar&#10;            InetAddress localHost = InetAddress.getLocalHost();&#10;            String ip = localHost.getHostAddress();&#10;&#10;            if (!ip.startsWith(&quot;127.&quot;) &amp;&amp; !ip.startsWith(&quot;192.168.56.&quot;)) {&#10;                return ip;&#10;            }&#10;&#10;            // Último recurso&#10;            System.err.println(&quot;⚠️  No se detectó IP de red real. Usando localhost.&quot;);&#10;            System.err.println(&quot; Conecta a WiFi o Ethernet para usar en red.&quot;);&#10;            return &quot;localhost&quot;;&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;⚠️  Error detectando IP, usando localhost&quot;);&#10;            e.printStackTrace();&#10;            return &quot;localhost&quot;;&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/medical/jade/launcher/RemoteContainer.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/medical/jade/launcher/RemoteContainer.java" />
              <option name="originalContent" value="package com.medical.jade.launcher;&#10;&#10;import jade.core.Runtime;&#10;import jade.core.Profile;&#10;import jade.core.ProfileImpl;&#10;import jade.wrapper.AgentController;&#10;import jade.wrapper.ContainerController;&#10;import java.net.InetAddress;&#10;import java.net.NetworkInterface;&#10;import java.util.Enumeration;&#10;&#10;/**&#10; * RemoteContainer - Contenedor remoto para ejecutar en otra computadora&#10; * Este contenedor ejecuta el agente Doctor&#10; *&#10; * INSTRUCCIONES RÁPIDAS:&#10; * 1. Ejecuta MainContainer.java en la COMPUTADORA PRINCIPAL primero&#10; * 2. Copia la IP que muestra MainContainer&#10; * 3. Pégala en la variable 'mainHost' abajo (línea 29)&#10; * 4. Ejecuta este archivo&#10; * 5. El Doctor se conectará automáticamente&#10; */&#10;public class RemoteContainer {&#10;    public static void main(String[] args) {&#10;        try {&#10;            // ========================================&#10;            //  CONFIGURACIÓN - Edita SOLO esta línea&#10;            // ========================================&#10;&#10;            // ⬇️ PEGA AQUÍ LA IP QUE MUESTRA MainContainer&#10;            String mainHost = &quot;10.211.172.68&quot;;&#10;&#10;            // Ejemplos:&#10;            // String mainHost = &quot;192.168.1.100&quot;;  // IP de la computadora principal&#10;            // String mainHost = &quot;10.0.0.5&quot;;       // Otra IP posible&#10;&#10;            // ========================================&#10;&#10;            // Detectar la IP local de ESTA computadora (evitando VirtualBox)&#10;            String localIP = getRealLocalIP();&#10;&#10;            System.out.println(&quot;\n===========================================&quot;);&#10;            System.out.println(&quot; INICIANDO CONTENEDOR REMOTO...&quot;);&#10;            System.out.println(&quot;===========================================&quot;);&#10;            System.out.println(&quot; IP de esta computadora: &quot; + localIP);&#10;            System.out.println(&quot; Intentando conectar a: &quot; + mainHost + &quot;:1099&quot;);&#10;            System.out.println(&quot;⏳ Esto puede tomar unos segundos...\n&quot;);&#10;&#10;            // Configuración del contenedor remoto&#10;            Runtime rt = Runtime.instance();&#10;            Profile profile = new ProfileImpl();&#10;            profile.setParameter(Profile.MAIN_HOST, mainHost);&#10;            profile.setParameter(Profile.MAIN_PORT, &quot;1099&quot;);&#10;            profile.setParameter(Profile.LOCAL_HOST, localIP);  // ⬅️ CRÍTICO: IP local correcta&#10;            profile.setParameter(Profile.CONTAINER_NAME, &quot;remote-container&quot;);&#10;&#10;            // Crear contenedor remoto&#10;            ContainerController remoteContainer = rt.createAgentContainer(profile);&#10;&#10;            System.out.println(&quot;✅ Conexión establecida con el MainContainer&quot;);&#10;            System.out.println(&quot;===========================================\n&quot;);&#10;&#10;            // Crear agente Doctor&#10;            System.out.println(&quot;‍⚕️ Creando agente Doctor...&quot;);&#10;            AgentController doctor = remoteContainer.createNewAgent(&#10;                    &quot;Doctor&quot;,&#10;                    &quot;com.medical.jade.agents.DoctorAgent&quot;,&#10;                    null&#10;            );&#10;&#10;            doctor.start();&#10;&#10;            System.out.println(&quot;\n===========================================&quot;);&#10;            System.out.println(&quot;✅ CONTENEDOR REMOTO ACTIVO&quot;);&#10;            System.out.println(&quot;===========================================&quot;);&#10;            System.out.println(&quot; IP local: &quot; + localIP);&#10;            System.out.println(&quot; Conectado a: &quot; + mainHost);&#10;            System.out.println(&quot;‍⚕️ Agente activo: Doctor&quot;);&#10;            System.out.println(&quot;===========================================&quot;);&#10;            System.out.println(&quot;\n El Doctor está listo para atender pacientes&quot;);&#10;            System.out.println(&quot; Comunicándose con la computadora principal&quot;);&#10;            System.out.println(&quot;\n⚠️  Mantén esta ventana abierta para que el Doctor siga activo\n&quot;);&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;\n===========================================&quot;);&#10;            System.err.println(&quot;❌ ERROR AL CONECTAR CON LA COMPUTADORA PRINCIPAL&quot;);&#10;            System.err.println(&quot;===========================================&quot;);&#10;            System.err.println(&quot;\n CHECKLIST DE SOLUCIÓN:&quot;);&#10;            System.err.println(&quot;   ❌ Verifica que MainContainer esté ejecutándose primero&quot;);&#10;            System.err.println(&quot;   ❌ Asegúrate de copiar la IP CORRECTA que muestra MainContainer&quot;);&#10;            System.err.println(&quot;   ❌ Verifica que ambas computadoras estén en la MISMA RED&quot;);&#10;            System.err.println(&quot;   ❌ Verifica que el firewall permita el puerto 1099&quot;);&#10;            System.err.println(&quot;\n SOLUCIÓN COMÚN DE FIREWALL:&quot;);&#10;            System.err.println(&quot;   Windows:&quot;);&#10;            System.err.println(&quot;      Panel de Control &gt; Firewall &gt; Permitir aplicación&quot;);&#10;            System.err.println(&quot;      Agregar Java/javaw.exe a la lista&quot;);&#10;            System.err.println(&quot;\n   Linux:&quot;);&#10;            System.err.println(&quot;      sudo ufw allow 1099/tcp&quot;);&#10;            System.err.println(&quot;      sudo firewall-cmd --add-port=1099/tcp (Fedora/CentOS)&quot;);&#10;            System.err.println(&quot;\n VERIFICAR CONECTIVIDAD:&quot;);&#10;            System.err.println(&quot;   Desde esta computadora, ejecuta:&quot;);&#10;            System.err.println(&quot;      ping [IP_DE_COMPUTADORA_PRINCIPAL]&quot;);&#10;            System.err.println(&quot;      telnet [IP_DE_COMPUTADORA_PRINCIPAL] 1099&quot;);&#10;            System.err.println(&quot;===========================================\n&quot;);&#10;&#10;            System.err.println(&quot;Detalles técnicos del error:&quot;);&#10;            e.printStackTrace();&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Obtiene la IP local real, evitando direcciones loopback y VirtualBox&#10;     */&#10;    private static String getRealLocalIP() {&#10;        try {&#10;            Enumeration&lt;NetworkInterface&gt; networkInterfaces = NetworkInterface.getNetworkInterfaces();&#10;&#10;            while (networkInterfaces.hasMoreElements()) {&#10;                NetworkInterface ni = networkInterfaces.nextElement();&#10;&#10;                // Saltar interfaces loopback, no activas, y VirtualBox&#10;                if (ni.isLoopback() || !ni.isUp() || ni.getDisplayName().toLowerCase().contains(&quot;virtual&quot;)) {&#10;                    continue;&#10;                }&#10;&#10;                // Preferir interfaces WiFi o Ethernet&#10;                String niName = ni.getName().toLowerCase();&#10;                boolean isPreferred = niName.startsWith(&quot;wlan&quot;) ||&#10;                                     niName.startsWith(&quot;eth&quot;) ||&#10;                                     niName.startsWith(&quot;en&quot;) ||&#10;                                     niName.startsWith(&quot;wlp&quot;);&#10;&#10;                Enumeration&lt;InetAddress&gt; addresses = ni.getInetAddresses();&#10;                while (addresses.hasMoreElements()) {&#10;                    InetAddress addr = addresses.nextElement();&#10;&#10;                    // Buscar IPv4 que NO sea loopback ni VirtualBox&#10;                    String hostAddress = addr.getHostAddress();&#10;                    if (!addr.isLoopbackAddress() &amp;&amp;&#10;                        hostAddress.indexOf(':') == -1 &amp;&amp;  // No IPv6&#10;                        !hostAddress.startsWith(&quot;127.&quot;) &amp;&amp;&#10;                        !hostAddress.startsWith(&quot;192.168.56.&quot;) &amp;&amp; // VirtualBox&#10;                        !hostAddress.startsWith(&quot;192.168.122.&quot;)) { // Otras VMs&#10;&#10;                        if (isPreferred) {&#10;                            return hostAddress; // Retornar inmediatamente si es una interfaz preferida&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            // Fallback: intentar método estándar&#10;            InetAddress localHost = InetAddress.getLocalHost();&#10;            String ip = localHost.getHostAddress();&#10;&#10;            if (!ip.startsWith(&quot;127.&quot;) &amp;&amp; !ip.startsWith(&quot;192.168.56.&quot;)) {&#10;                return ip;&#10;            }&#10;&#10;            // Último recurso&#10;            System.err.println(&quot;⚠️  No se detectó IP de red real. Usando localhost.&quot;);&#10;            System.err.println(&quot; Conecta a WiFi o Ethernet para usar en red.&quot;);&#10;            return &quot;localhost&quot;;&#10;&#10;        } catch (Exception e) {&#10;            System.err.println(&quot;⚠️  Error detectando IP, usando localhost&quot;);&#10;            e.printStackTrace();&#10;            return &quot;localhost&quot;;&#10;        }&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.medical.jade.launcher;&#13;&#10;&#13;&#10;import com.medical.jade.agents.NetworkBridgeAgent;&#13;&#10;import jade.core.Runtime;&#13;&#10;import jade.core.Profile;&#13;&#10;import jade.core.ProfileImpl;&#13;&#10;import jade.wrapper.AgentController;&#13;&#10;import jade.wrapper.ContainerController;&#13;&#10;import java.net.InetAddress;&#13;&#10;import java.net.NetworkInterface;&#13;&#10;import java.util.Enumeration;&#13;&#10;&#13;&#10;/**&#13;&#10; * RemoteContainer - Contenedor remoto para ejecutar en otra computadora&#13;&#10; * Este contenedor ejecuta el agente Doctor&#13;&#10; *&#13;&#10; * INSTRUCCIONES RÁPIDAS:&#13;&#10; * 1. Ejecuta MainContainer.java en la COMPUTADORA PRINCIPAL primero&#13;&#10; * 2. Copia la IP que muestra MainContainer&#13;&#10; * 3. Pégala en la variable 'mainHost' abajo (línea 29)&#13;&#10; * 4. Ejecuta este archivo&#13;&#10; * 5. El Doctor se conectará automáticamente&#13;&#10; */&#13;&#10;public class RemoteContainer {&#13;&#10;    public static void main(String[] args) {&#13;&#10;        try {&#13;&#10;            // ========================================&#13;&#10;            //  CONFIGURACIÓN - Edita SOLO esta línea&#13;&#10;            // ========================================&#13;&#10;&#13;&#10;            // ⬇️ PEGA AQUÍ LA IP QUE MUESTRA MainContainer&#13;&#10;            String mainHost = &quot;10.211.172.68&quot;;&#13;&#10;            int bridgePort = Integer.parseInt(System.getProperty(&#13;&#10;                    &quot;bridge.port&quot;,&#13;&#10;                    String.valueOf(NetworkBridgeAgent.DEFAULT_PORT)));&#13;&#10;&#13;&#10;            // Ejemplos:&#13;&#10;            // String mainHost = &quot;192.168.1.100&quot;;  // IP de la computadora principal&#13;&#10;            // String mainHost = &quot;10.0.0.5&quot;;       // Otra IP posible&#13;&#10;&#13;&#10;            // ========================================&#13;&#10;&#13;&#10;            // Detectar la IP local de ESTA computadora (evitando VirtualBox)&#13;&#10;            String localIP = getRealLocalIP();&#13;&#10;&#13;&#10;            System.out.println(&quot;\n===========================================&quot;);&#13;&#10;            System.out.println(&quot; INICIANDO CONTENEDOR REMOTO...&quot;);&#13;&#10;            System.out.println(&quot;===========================================&quot;);&#13;&#10;            System.out.println(&quot; IP de esta computadora: &quot; + localIP);&#13;&#10;            System.out.println(&quot; Intentando conectar a: &quot; + mainHost + &quot;:1099&quot;);&#13;&#10;            System.out.println(&quot; Puerto socket puente: &quot; + bridgePort);&#13;&#10;            System.out.println(&quot;⏳ Esto puede tomar unos segundos...\n&quot;);&#13;&#10;&#13;&#10;            // Configuración del contenedor remoto&#13;&#10;            Runtime rt = Runtime.instance();&#13;&#10;            Profile profile = new ProfileImpl();&#13;&#10;            profile.setParameter(Profile.MAIN_HOST, mainHost);&#13;&#10;            profile.setParameter(Profile.MAIN_PORT, &quot;1099&quot;);&#13;&#10;            profile.setParameter(Profile.LOCAL_HOST, localIP);  // ⬅️ CRÍTICO: IP local correcta&#13;&#10;            profile.setParameter(Profile.CONTAINER_NAME, &quot;remote-container&quot;);&#13;&#10;&#13;&#10;            // Crear contenedor remoto&#13;&#10;            ContainerController remoteContainer = rt.createAgentContainer(profile);&#13;&#10;&#13;&#10;            System.out.println(&quot;✅ Conexión establecida con el MainContainer&quot;);&#13;&#10;            System.out.println(&quot;===========================================\n&quot;);&#13;&#10;&#13;&#10;            // Crear agente Doctor&#13;&#10;            System.out.println(&quot;‍⚕️ Creando agente Doctor...&quot;);&#13;&#10;            AgentController doctor = remoteContainer.createNewAgent(&#13;&#10;                    &quot;Doctor&quot;,&#13;&#10;                    &quot;com.medical.jade.agents.DoctorAgent&quot;,&#13;&#10;                    null&#13;&#10;            );&#13;&#10;&#13;&#10;            doctor.start();&#13;&#10;&#13;&#10;            // Crear bridge TCP en modo cliente hacia la computadora principal&#13;&#10;            System.out.println(&quot; Conectando bridge TCP al host principal...&quot;);&#13;&#10;            AgentController networkBridge = remoteContainer.createNewAgent(&#13;&#10;                    NetworkBridgeAgent.AGENT_NAME,&#13;&#10;                    &quot;com.medical.jade.agents.NetworkBridgeAgent&quot;,&#13;&#10;                    new Object[]{NetworkBridgeAgent.Mode.CLIENT.name(), mainHost, bridgePort}&#13;&#10;            );&#13;&#10;            networkBridge.start();&#13;&#10;&#13;&#10;            System.out.println(&quot;===========================================&quot;);&#13;&#10;            System.out.println(&quot;‍⚕️ Agente activo: Doctor&quot;);&#13;&#10;            System.out.println(&quot; Bridge TCP activo en puerto remoto: &quot; + bridgePort);&#13;&#10;            System.out.println(&quot;===========================================&quot;);&#13;&#10;            System.out.println(&quot;\n El Doctor está listo para atender pacientes&quot;);&#13;&#10;            System.out.println(&quot; Comunicándose con la computadora principal&quot;);&#13;&#10;            System.out.println(&quot;\n⚠️  Mantén esta ventana abierta para que el Doctor siga activo\n&quot;);&#13;&#10;&#13;&#10;        } catch (Exception e) {&#13;&#10;            System.err.println(&quot;\n===========================================&quot;);&#13;&#10;            System.err.println(&quot;❌ ERROR AL CONECTAR CON LA COMPUTADORA PRINCIPAL&quot;);&#13;&#10;            System.err.println(&quot;===========================================&quot;);&#13;&#10;            System.err.println(&quot;\n CHECKLIST DE SOLUCIÓN:&quot;);&#13;&#10;            System.err.println(&quot;   ❌ Verifica que MainContainer esté ejecutándose primero&quot;);&#13;&#10;            System.err.println(&quot;   ❌ Asegúrate de copiar la IP CORRECTA que muestra MainContainer&quot;);&#13;&#10;            System.err.println(&quot;   ❌ Verifica que ambas computadoras estén en la MISMA RED&quot;);&#13;&#10;            System.err.println(&quot;   ❌ Verifica que el firewall permita el puerto 1099&quot;);&#13;&#10;            System.err.println(&quot;\n SOLUCIÓN COMÚN DE FIREWALL:&quot;);&#13;&#10;            System.err.println(&quot;   Windows:&quot;);&#13;&#10;            System.err.println(&quot;      Panel de Control &gt; Firewall &gt; Permitir aplicación&quot;);&#13;&#10;            System.err.println(&quot;      Agregar Java/javaw.exe a la lista&quot;);&#13;&#10;            System.err.println(&quot;\n   Linux:&quot;);&#13;&#10;            System.err.println(&quot;      sudo ufw allow 1099/tcp&quot;);&#13;&#10;            System.err.println(&quot;      sudo firewall-cmd --add-port=1099/tcp (Fedora/CentOS)&quot;);&#13;&#10;            System.err.println(&quot;\n VERIFICAR CONECTIVIDAD:&quot;);&#13;&#10;            System.err.println(&quot;   Desde esta computadora, ejecuta:&quot;);&#13;&#10;            System.err.println(&quot;      ping [IP_DE_COMPUTADORA_PRINCIPAL]&quot;);&#13;&#10;            System.err.println(&quot;      telnet [IP_DE_COMPUTADORA_PRINCIPAL] 1099&quot;);&#13;&#10;            System.err.println(&quot;===========================================\n&quot;);&#13;&#10;&#13;&#10;            System.err.println(&quot;Detalles técnicos del error:&quot;);&#13;&#10;            e.printStackTrace();&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    /**&#13;&#10;     * Obtiene la IP local real, evitando direcciones loopback y VirtualBox&#13;&#10;     */&#13;&#10;    private static String getRealLocalIP() {&#13;&#10;        try {&#13;&#10;            Enumeration&lt;NetworkInterface&gt; networkInterfaces = NetworkInterface.getNetworkInterfaces();&#13;&#10;&#13;&#10;            while (networkInterfaces.hasMoreElements()) {&#13;&#10;                NetworkInterface ni = networkInterfaces.nextElement();&#13;&#10;&#13;&#10;                // Saltar interfaces loopback, no activas, y VirtualBox&#13;&#10;                if (ni.isLoopback() || !ni.isUp() || ni.getDisplayName().toLowerCase().contains(&quot;virtual&quot;)) {&#13;&#10;                    continue;&#13;&#10;                }&#13;&#10;&#13;&#10;                // Preferir interfaces WiFi o Ethernet&#13;&#10;                String niName = ni.getName().toLowerCase();&#13;&#10;                boolean isPreferred = niName.startsWith(&quot;wlan&quot;) ||&#13;&#10;                                     niName.startsWith(&quot;eth&quot;) ||&#13;&#10;                                     niName.startsWith(&quot;en&quot;) ||&#13;&#10;                                     niName.startsWith(&quot;wlp&quot;);&#13;&#10;&#13;&#10;                Enumeration&lt;InetAddress&gt; addresses = ni.getInetAddresses();&#13;&#10;                while (addresses.hasMoreElements()) {&#13;&#10;                    InetAddress addr = addresses.nextElement();&#13;&#10;&#13;&#10;                    // Buscar IPv4 que NO sea loopback ni VirtualBox&#13;&#10;                    String hostAddress = addr.getHostAddress();&#13;&#10;                    if (!addr.isLoopbackAddress() &amp;&amp;&#13;&#10;                        hostAddress.indexOf(':') == -1 &amp;&amp;  // No IPv6&#13;&#10;                        !hostAddress.startsWith(&quot;127.&quot;) &amp;&amp;&#13;&#10;                        !hostAddress.startsWith(&quot;192.168.56.&quot;) &amp;&amp; // VirtualBox&#13;&#10;                        !hostAddress.startsWith(&quot;192.168.122.&quot;)) { // Otras VMs&#13;&#10;&#13;&#10;                        if (isPreferred) {&#13;&#10;                            return hostAddress; // Retornar inmediatamente si es una interfaz preferida&#13;&#10;                        }&#13;&#10;                    }&#13;&#10;                }&#13;&#10;            }&#13;&#10;&#13;&#10;            // Fallback: intentar método estándar&#13;&#10;            InetAddress localHost = InetAddress.getLocalHost();&#13;&#10;            String ip = localHost.getHostAddress();&#13;&#10;&#13;&#10;            if (!ip.startsWith(&quot;127.&quot;) &amp;&amp; !ip.startsWith(&quot;192.168.56.&quot;)) {&#13;&#10;                return ip;&#13;&#10;            }&#13;&#10;&#13;&#10;            // Último recurso&#13;&#10;            System.err.println(&quot;⚠️  No se detectó IP de red real. Usando localhost.&quot;);&#13;&#10;            System.err.println(&quot; Conecta a WiFi o Ethernet para usar en red.&quot;);&#13;&#10;            return &quot;localhost&quot;;&#13;&#10;&#13;&#10;        } catch (Exception e) {&#13;&#10;            System.err.println(&quot;⚠️  Error detectando IP, usando localhost&quot;);&#13;&#10;            e.printStackTrace();&#13;&#10;            return &quot;localhost&quot;;&#13;&#10;        }&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>